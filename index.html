<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proceso de Barrido en Farmacia IPAM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals with Teal Accent -->
    <!-- Application Structure Plan: Se ha diseñado una SPA de una sola página con desplazamiento vertical y una barra de navegación fija. La estructura se divide en secciones temáticas: 1) Introducción, 2) Flujo del Proceso Interactivo, 3) Comparativa por Sector, 4) Beneficios Clave, 5) Preguntas Frecuentes y 6) Evaluación. Esta arquitectura fue elegida para transformar un documento procedimental en una guía de aprendizaje y evaluación interactiva. -->
    <!-- Visualization & Content Choices: 1. Flujo del Proceso: Se reemplazó el diagrama estático por una secuencia de pasos interactivos en HTML/CSS. 2. Comparativa de Sectores: Se usó un gráfico de dona (Chart.js) y botones interactivos. 3. Beneficios: Se presentan en tarjetas con íconos (Unicode). 4. FAQ: Se implementó un acordeón con JS. 5. Evaluación: Se añadió una sección con preguntas de opción múltiple (única y múltiple), con un botón de revisión final protegido por contraseña para mostrar las respuestas correctas. Justificación: Estas elecciones priorizan la interacción y la claridad visual para facilitar el aprendizaje y la evaluación de un proceso operativo. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 350px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        .step-connector {
            width: 2px;
            height: 100%;
            background-color: #D1D5DB;
            position: absolute;
            left: 20px;
            top: 20px;
            z-index: -1;
        }
        .step.active .step-icon {
            background-color: #14B8A6;
            color: white;
            transform: scale(1.1);
        }
        .step.active .step-content {
            border-color: #14B8A6;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .faq-item .faq-answer {
            display: none;
            transition: max-height 0.3s ease-out;
            overflow: hidden;
            max-height: 0;
        }
        .faq-item.open .faq-answer {
            display: block;
            max-height: 200px; /* Adjust as needed */
        }
        .faq-item.open .faq-icon {
            transform: rotate(180deg);
        }
        .sector-btn.active {
            background-color: #14B8A6;
            color: white;
            border-color: #14B8A6;
        }
        .mc-option-label.correct {
            background-color: #D1FAE5;
            border-color: #10B981;
            color: #065F46;
        }
        .mc-option-label.incorrect {
            background-color: #FEE2E2;
            border-color: #EF4444;
            color: #991B1B;
        }
    </style>
</head>
<body class="antialiased">

    <div id="password-overlay" class="fixed inset-0 bg-gray-100 z-50 flex items-center justify-center p-4">
        <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-sm text-center">
            <h2 class="text-2xl font-bold text-gray-800 mb-2">Acceso Restringido</h2>
            <p class="text-gray-600 mb-6">Esta documentación es para uso interno.</p>
            <form id="password-form">
                <label for="password-input" class="sr-only">Contraseña</label>
                <input id="password-input" type="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-4 text-center focus:ring-2 focus:ring-teal-500 focus:border-teal-500" placeholder="Ingrese la contraseña" autofocus>
                <button type="submit" class="w-full bg-teal-600 text-white py-2 rounded-lg hover:bg-teal-700 transition-colors font-semibold">Ingresar</button>
                <p id="error-message" class="text-red-500 text-sm mt-4 hidden">Contraseña incorrecta. Intente de nuevo.</p>
            </form>
        </div>
    </div>

    <div id="main-content" class="hidden">
        <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-40">
            <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
                <div class="text-2xl font-bold text-teal-600">
                    <span class="text-gray-700">Farmacia Interna:</span> Proceso de Barrido
                </div>
                <div class="hidden md:flex space-x-6 text-gray-600 font-medium">
                    <a href="#proceso" class="hover:text-teal-600 transition-colors">El Proceso</a>
                    <a href="#comparativa" class="hover:text-teal-600 transition-colors">Por Sector</a>
                    <a href="#beneficios" class="hover:text-teal-600 transition-colors">Beneficios</a>
                    <a href="#faq" class="hover:text-teal-600 transition-colors">Preguntas Frecuentes</a>
                    <a href="#evaluacion" class="hover:text-teal-600 transition-colors">Evaluación</a>
                </div>
                <button id="mobile-menu-button" class="md:hidden p-2 rounded-md hover:bg-gray-100 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </nav>
            <div id="mobile-menu" class="hidden md:hidden px-6 pb-4 space-y-2">
                 <a href="#proceso" class="block text-gray-600 hover:text-teal-600 transition-colors py-2">El Proceso</a>
                 <a href="#comparativa" class="block text-gray-600 hover:text-teal-600 transition-colors py-2">Por Sector</a>
                 <a href="#beneficios" class="block text-gray-600 hover:text-teal-600 transition-colors py-2">Beneficios</a>
                 <a href="#faq" class="block text-gray-600 hover:text-teal-600 transition-colors py-2">Preguntas Frecuentes</a>
                 <a href="#evaluacion" class="block text-gray-600 hover:text-teal-600 transition-colors py-2">Evaluación</a>
            </div>
        </header>

        <main class="container mx-auto px-6 py-12 md:py-20">

            <section id="introduccion" class="text-center mb-20">
                <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">Entendiendo el Proceso de Barrido</h1>
                <p class="max-w-3xl mx-auto text-lg text-gray-600">
                    Una guía interactiva para comprender cómo la farmacia interna garantiza el abastecimiento de medicamentos e insumos de manera eficiente y segura a todos los sectores del sanatorio.
                </p>
            </section>

            <section id="proceso" class="mb-20">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-4">El Flujo del Proceso, Paso a Paso</h2>
                <p class="text-center text-gray-600 mb-12 max-w-2xl mx-auto">
                    El barrido es una función automatizada que transforma las necesidades de los pacientes en pedidos concretos para la farmacia. Haga clic en cada paso para ver los detalles y entender cómo funciona el ciclo completo.
                </p>
                <div id="process-steps" class="relative">
                    <div class="step-connector hidden md:block"></div>
                    
                    <div class="step mb-8 md:flex items-start" data-step="1">
                        <div class="flex-shrink-0 mr-6 flex items-center mb-4 md:mb-0">
                            <div class="step-icon w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold text-lg transition-all duration-300">1</div>
                        </div>
                        <div class="step-content flex-grow bg-white p-6 rounded-lg border-2 border-transparent transition-all duration-300 cursor-pointer">
                            <h3 class="font-bold text-xl mb-2 text-gray-800">Inicio y Parametrización</h3>
                            <p class="text-gray-600">El personal de farmacia inicia el proceso presionando "Generacion de Pedidos.." y define los parámetros clave: el **sector** a abastecer (ej. Piso 3) y un **rango horario** (ej. de 08:00 a 14:00).</p>
                        </div>
                    </div>

                    <div class="step mb-8 md:flex items-start" data-step="2">
                        <div class="flex-shrink-0 mr-6 flex items-center mb-4 md:mb-0">
                            <div class="step-icon w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold text-lg transition-all duration-300">2</div>
                        </div>
                        <div class="step-content flex-grow bg-white p-6 rounded-lg border-2 border-transparent transition-all duration-300 cursor-pointer">
                            <h3 class="font-bold text-xl mb-2 text-gray-800">Análisis Inteligente del Sistema</h3>
                            <p class="text-gray-600">El sistema revisa todos los pacientes del sector y sus prescripciones médicas. Filtra y considera únicamente los insumos y medicamentos planificados y que se necesitan dentro del rango horario seleccionado.</p>
                        </div>
                    </div>

                    <div class="step mb-8 md:flex items-start" data-step="3">
                        <div class="flex-shrink-0 mr-6 flex items-center mb-4 md:mb-0">
                            <div class="step-icon w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold text-lg transition-all duration-300">3</div>
                        </div>
                        <div class="step-content flex-grow bg-white p-6 rounded-lg border-2 border-transparent transition-all duration-300 cursor-pointer">
                            <h3 class="font-bold text-xl mb-2 text-gray-800">Generación de Pedidos Adaptativa</h3>
                            <p class="text-gray-600">Aquí el proceso se adapta. Para **Internación Común**, genera pedidos individuales por paciente. Para **Terapia/UCO**, se crean pedidos por paciente de insumos para reponer el stock del sector.</p>
                        </div>
                    </div>
                    
                    <div class="step mb-8 md:flex items-start" data-step="4">
                        <div class="flex-shrink-0 mr-6 flex items-center mb-4 md:mb-0">
                            <div class="step-icon w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold text-lg transition-all duration-300">4</div>
                        </div>
                        <div class="step-content flex-grow bg-white p-6 rounded-lg border-2 border-transparent transition-all duration-300 cursor-pointer">
                            <h3 class="font-bold text-xl mb-2 text-gray-800">Registro y Trazabilidad</h3>
                            <p class="text-gray-600">Todos los pedidos generados quedan registrados en el sistema con un ID único, fecha, usuario responsable y el detalle completo, asegurando una trazabilidad total del proceso.</p>
                        </div>
                    </div>

                    <div class="step md:flex items-start" data-step="5">
                        <div class="flex-shrink-0 mr-6 flex items-center mb-4 md:mb-0">
                            <div class="step-icon w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold text-lg transition-all duration-300">5</div>
                        </div>
                        <div class="step-content flex-grow bg-white p-6 rounded-lg border-2 border-transparent transition-all duration-300 cursor-pointer">
                            <h3 class="font-bold text-xl mb-2 text-gray-800">Preparación y Entrega</h3>
                            <p class="text-gray-600">Con los pedidos ya generados, el equipo de farmacia prepara la medicación y los insumos para su envío al sector correspondiente, cerrando el ciclo de abastecimiento.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="comparativa" class="mb-20">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-4">Diferencias Clave por Tipo de Sector</h2>
                <p class="text-center text-gray-600 mb-12 max-w-2xl mx-auto">
                    El barrido no funciona igual para todos. La principal diferencia radica en si el sector maneja su propio stock de insumos.
                </p>
                <div class="lg:flex lg:space-x-12 items-center">
                    <div class="lg:w-1/3 mb-8 lg:mb-0">
                        <div class="chart-container">
                            <canvas id="sectorChart"></canvas>
                        </div>
                    </div>
                    <div class="lg:w-2/3">
                        <div class="mb-6 flex justify-center space-x-4">
                            <button class="sector-btn active px-6 py-2 border-2 border-gray-300 rounded-full font-medium transition-all" data-sector="comun">Internación Común</button>
                            <button class="sector-btn px-6 py-2 border-2 border-gray-300 rounded-full font-medium transition-all" data-sector="criticos">Terapia / UCO</button>
                        </div>
                        <div class="bg-white p-8 rounded-lg shadow-md">
                            <div id="sector-info">
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="beneficios" class="mb-20">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Ventajas Principales del Barrido</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">✅</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Reduce Faltantes</h3>
                        <p class="text-gray-600">Al anticipar la demanda, se disminuye drásticamente el riesgo de que falten medicamentos o insumos críticos.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">⚙️</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Automatiza Pedidos</h3>
                        <p class="text-gray-600">Elimina la necesidad de generar pedidos manualmente, ahorrando tiempo y minimizando errores humanos.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">🔍</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Mejora la Trazabilidad</h3>
                        <p class="text-gray-600">Cada entrega queda registrada, permitiendo un control y seguimiento exhaustivo de los insumos dispensados.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">🎯</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Evita Errores de Carga</h3>
                        <p class="text-gray-600">Al basarse en la prescripción médica digital, se evitan errores de transcripción o interpretación.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">🔄</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Proceso Adaptable</h3>
                        <p class="text-gray-600">El sistema se ajusta a la realidad operativa de cada sector, ya sea por paciente o por reposición de stock.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">⏰</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Optimiza el Tiempo</h3>
                        <p class="text-gray-600">Permite al personal de farmacia y enfermería enfocarse en tareas de mayor valor, mejorando la eficiencia general.</p>
                    </div>
                </div>
            </section>

            <section id="faq" class="mb-20">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Preguntas Frecuentes</h2>
                <div class="max-w-3xl mx-auto space-y-4">
                    <div class="faq-item bg-white rounded-lg shadow-sm overflow-hidden">
                        <div class="faq-question flex justify-between items-center p-6 cursor-pointer">
                            <h3 class="font-semibold text-lg text-gray-800">¿Qué pasa si realizo un barrido para un período que ya pasó?</h3>
                            <div class="faq-icon text-gray-500 transition-transform duration-300">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                        </div>
                        <div class="faq-answer px-6 pb-6 text-gray-600">
                            <p>Es posible volver a ejecutar un barrido sobre un período ya procesado.
En ese caso, el sistema no genera pedidos duplicados.

Si ya se generaron pedidos y fueron procesados correctamente, el sistema no los vuelve a incluir.

Si los pedidos generados aún no fueron procesados (es decir, no se prepararon ni se enviaron), siguen vigentes.

Si hubo modificaciones en la planificación (por ejemplo, cambios en indicaciones médicas), entonces el sistema genera nuevos pedidos actualizados para reflejar esos cambios. </p>
                        </div>
                    </div>
                    <div class="faq-item bg-white rounded-lg shadow-sm overflow-hidden">
                        <div class="faq-question flex justify-between items-center p-6 cursor-pointer">
                            <h3 class="font-semibold text-lg text-gray-800">¿Con cuánta anticipación debo realizar el barrido?</h3>
                            <div class="faq-icon text-gray-500 transition-transform duration-300">
                               <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                        </div>
                        <div class="faq-answer px-6 pb-6 text-gray-600">
                            <p>Depende de los cronogramas de cada sector. Como regla general, se recomienda realizarlo con un mínimo de **2 a 4 horas de antelación** para dar tiempo suficiente a la preparación y el envío de los insumos.</p>
                        </div>
                    </div>
                     <div class="faq-item bg-white rounded-lg shadow-sm overflow-hidden">
                        <div class="faq-question flex justify-between items-center p-6 cursor-pointer">
                            <h3 class="font-semibold text-lg text-gray-800">¿El barrido incluye medicación "SOS" o "según necesidad"?</h3>
                            <div class="faq-icon text-gray-500 transition-transform duration-300">
                               <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                        </div>
                        <div class="faq-answer px-6 pb-6 text-gray-600">
                            <p>Sí. El barrido incluye tanto los medicamentos programados con horario específico según la prescripción médica, como aquellos indicados como “SOS”, siempre que estén vigentes dentro del rango horario seleccionado.</p>
                        </div>
                    </div>
                    <div class="faq-item bg-white rounded-lg shadow-sm overflow-hidden">
                        <div class="faq-question flex justify-between items-center p-6 cursor-pointer">
                            <h3 class="font-semibold text-lg text-gray-800">¿Qué ocurre si un médico cambia una prescripción después del barrido?</h3>
                            <div class="faq-icon text-gray-500 transition-transform duration-300">
                               <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                        </div>
                        <div class="faq-answer px-6 pb-6 text-gray-600">
                            <p>El barrido representa una “foto” del estado de la prescripción médica y la planificación de administración en el momento en que se ejecuta.
Cualquier cambio posterior —como una suspensión, una nueva indicación, una modificación de dosis u horario, o un ajuste en la planificación— no se refleja automáticamente en el pedido ya generado.
Para que esos cambios se vean reflejados, debe realizarse un nuevo barrido, que genere un pedido actualizado.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="evaluacion" class="bg-white p-8 rounded-lg shadow-md">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-2">Evaluación de Conocimientos</h2>
                <p class="text-center text-gray-600 mb-10">Verifique su comprensión del proceso de barrido y gestión de stock.</p>

                <div class="max-w-4xl mx-auto">
                    <div class="mb-8">
                        <label for="evaluado-nombre" class="block text-lg font-medium text-gray-700 mb-2">Nombre del Evaluado:</label>
                        <input type="text" id="evaluado-nombre" name="evaluado-nombre" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500" placeholder="Ingrese su nombre y apellido">
                        <div class="text-center mt-4">
                            <button id="start-evaluation-btn" class="bg-teal-600 text-white py-2 px-6 rounded-lg hover:bg-teal-700 transition-colors font-semibold">Comenzar Evaluación</button>
                            <p id="name-error" class="text-red-500 text-sm mt-2 hidden">Por favor, ingrese su nombre para comenzar.</p>
                        </div>
                    </div>

                    <div id="evaluation-content" class="hidden">
                        <h3 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2">Parte 1: Comprensión técnica</h3>
                        <div id="mc-questions-container-1" class="space-y-8"></div>

                        <h3 class="text-2xl font-bold text-gray-800 mt-12 mb-6 border-b pb-2">Parte 2: Situaciones prácticas complejas</h3>
                        <div id="mc-questions-container-2" class="space-y-8"></div>
                        
                        <div class="text-center mt-12">
                            <button id="check-answers-btn" class="bg-teal-600 text-white py-3 px-8 rounded-lg hover:bg-teal-700 transition-colors font-semibold text-lg">Revisar Respuestas Correctas</button>
                        </div>
                    </div>
                </div>
            </section>

        </main>
        
        <footer class="bg-gray-800 text-white mt-20">
            <div class="container mx-auto px-6 py-8 text-center">
                <p>&copy; 2024 Sanatorio IPAM. Documentación de Procesos Internos.</p>
                <p class="text-sm text-gray-400 mt-2">Documentación realizada por Emanuel Fleier (Depto. Sistemas).</p>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            const passwordOverlay = document.getElementById('password-overlay');
            const passwordForm = document.getElementById('password-form');
            const passwordInput = document.getElementById('password-input');
            const errorMessage = document.getElementById('error-message');
            const mainContent = document.getElementById('main-content');

            const correctPassword = 'ipam';

            passwordForm.addEventListener('submit', function(e) {
                e.preventDefault();
                if (passwordInput.value === correctPassword) {
                    passwordOverlay.style.display = 'none';
                    mainContent.classList.remove('hidden');
                } else {
                    errorMessage.classList.remove('hidden');
                    passwordInput.value = '';
                    passwordInput.focus();
                }
            });

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            const processSteps = document.querySelectorAll('.step');
            processSteps.forEach(step => {
                step.addEventListener('click', () => {
                    processSteps.forEach(s => s.classList.remove('active'));
                    step.classList.add('active');
                });
            });
            if (processSteps.length > 0) {
                processSteps[0].classList.add('active');
            }

            const sectorData = {
                comun: {
                    title: 'Internación Común',
                    details: [
                        { label: '¿Maneja stock propio?', value: 'No', icon: '❌' },
                        { label: 'Finalidad del barrido', value: 'Enviar medicación específica por paciente', icon: '🎯' },
                        { label: 'Tipo de pedido generado', value: 'Pedido individual por paciente', icon: '📄' }
                    ]
                },
                criticos: {
                    title: 'Terapia / UCO (Sectores Críticos)',
                    details: [
                        { label: '¿Maneja stock propio?', value: 'Sí', icon: '✅' },
                        { label: 'Finalidad del barrido', value: 'Reponer el stock general del sector', icon: '🎯' },
                        { label: 'Tipo de pedido generado', value: 'Pedido individual por paciente', icon: '📄' }
                    ]
                }
            };

            const sectorInfoContainer = document.getElementById('sector-info');
            const sectorButtons = document.querySelectorAll('.sector-btn');

            function updateSectorInfo(sector) {
                const data = sectorData[sector];
                let html = `<h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">${data.title}</h3><div class="space-y-4">`;
                data.details.forEach(item => {
                    html += `
                        <div class="flex items-start">
                            <div class="text-2xl mr-4">${item.icon}</div>
                            <div>
                                <p class="font-semibold text-gray-500">${item.label}</p>
                                <p class="text-lg text-gray-800">${item.value}</p>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                sectorInfoContainer.innerHTML = html;
            }

            sectorButtons.forEach(button => {
                button.addEventListener('click', () => {
                    sectorButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    updateSectorInfo(button.dataset.sector);
                });
            });

            updateSectorInfo('comun');

            const ctx = document.getElementById('sectorChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Internación Común', 'Sectores Críticos (Terapia/UCO)'],
                    datasets: [{
                        label: 'Tipos de Sector',
                        data: [70, 30],
                        backgroundColor: [
                            '#2DD4BF',
                            '#0D9488'
                        ],
                        borderColor: '#FDFBF8',
                        borderWidth: 4,
                        hoverOffset: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 14,
                                    family: 'Inter'
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed + '% (Representación)';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            const faqItems = document.querySelectorAll('.faq-item');
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                question.addEventListener('click', () => {
                    const isOpen = item.classList.contains('open');
                    faqItems.forEach(i => i.classList.remove('open'));
                    if (!isOpen) {
                        item.classList.add('open');
                    }
                });
            });

            // --- EVALUATION SCRIPT ---
            const nameInput = document.getElementById('evaluado-nombre');
            const startEvaluationBtn = document.getElementById('start-evaluation-btn');
            const nameError = document.getElementById('name-error');
            const evaluationContent = document.getElementById('evaluation-content');

            startEvaluationBtn.addEventListener('click', () => {
                if (nameInput.value.trim() === '') {
                    nameError.classList.remove('hidden');
                } else {
                    nameError.classList.add('hidden');
                    evaluationContent.classList.remove('hidden');
                    nameInput.disabled = true;
                    startEvaluationBtn.parentElement.style.display = 'none';
                }
            });

            const evaluationData = {
                multipleChoice: [
                    {
                        question: "¿Cuál es el objetivo del barrido realizado por farmacia en sectores sin stock propio, como internación general?",
                        options: { A: "Confirmar que todos los medicamentos hayan sido administrados correctamente", B: "Identificar los medicamentos que podrían reutilizarse en otros sectores", C: "Anticiparse a las necesidades de cada paciente generando pedidos por planificación futura", D: "Realizar auditorías retrospectivas sobre tratamientos administrados" },
                        correct: ["C"], type: 'single'
                    },
                    {
                        question: "Al realizar un barrido en un rango horario que ya fue previamente procesado, el sistema:",
                        options: { A: "Reemplaza los pedidos anteriores por versiones más recientes", B: "Genera alertas de duplicación y detiene el proceso", C: "No vuelve a generar pedidos para lo que ya fue procesado", D: "Elimina automáticamente los pedidos previos y vuelve a generarlos" },
                        correct: ["C"], type: 'single'
                    },
                    {
                        question: "¿Cuándo se considera que se van a generar nuevos pedidos para pacientes luego de un barrido previo?",
                        options: { A: "Siempre que haya un cambio en la planificación o en la medicación indicada", B: "Cuando el médico repite la indicación sin modificar horario o dosis", C: "Solo si se han entregado todos los insumos anteriores", D: "Si el sistema detecta devoluciones desde el sector" },
                        correct: ["A"], type: 'single'
                    },
                    {
                        question: "En sectores como Terapia Intensiva o UCO, ¿Cual es el motivo principal de la generacion de pedidos (barridos)?",
                        options: { A: "Porque estos sectores utilizan prescripción médicas individualizada", B: "Porque los medicamentos se administran a demanda sin planificación", C: "Porque mantienen stock en depósito, y el barrido sirve para reponer lo consumido.", D: "Porque ambos sectores comparten stock" },
                        correct: ["C"], type: 'single'
                    },
                    {
                        question: "¿Qué tipo de medicación/insumos es incluida por el sistema en un barrido? (selección múltiple)",
                        options: { A: "Medicación pautada con horario fijo", B: "Medicación \"SOS\" activa en la planificacion", C: "Insumos registrados como \"entregados previamente\"", D: "Medicación suspendida luego del barrido" },
                        correct: ["A", "B"], type: 'multiple'
                    },
                    {
                        question: "¿Cuál de las siguientes acciones debe realizar farmacia antes de reincorporar un medicamento al stock general?",
                        options: { A: "Confirmar que no haya sido administrado y esté en condiciones adecuadas", B: "Validar en sistema que no esté planificado nuevamente", C: "Solicitar autorización médica antes de su reintegro", D: "Reetiquetar el producto para indicar que es reutilizable" },
                        correct: ["A"], type: 'single'
                    },
                    {
                        question: "¿En qué situación el personal de farmacia no debería realizar un nuevo barrido?",
                        options: { A: "Al recibir una nueva indicación médica urgente", B: "Si el barrido ya se hizo para ese período y no hubo cambios", C: "Cuando se modifica la planificación de horarios de medicación", D: "Si se agregan medicamentos nuevos a un paciente internado" },
                        correct: ["C"], type: 'single'
                    },
                    {
                        question: "¿Por qué no es recomendable realizar un barrido con una fecha y hora en el pasado?",
                        options: { A: "Porque el sistema puede sobreescribir los registros clínicos", B: "Porque se generarían pedidos de insumos ya administrados o vencidos", C: "Porque se pierde trazabilidad de las entregas", D: "Ninguna de las anteriores" },
                        correct: ["D"], type: 'single'
                    },
                    {
                        question: "Al preparar un pedido generado por barrido, farmacia detecta que un insumo está próximo a vencer. ¿Qué debe hacer?",
                        options: { A: "Utilizarlo primero si está dentro del rango de seguridad", B: "Cambiar el medicamento por otro del mismo grupo farmacológico", C: "Consultar con el médico tratante antes de incluirlo en el pedido", D: "Eliminarlo del pedido directamente" },
                        correct: ["A"], type: 'single'
                    },
                    {
                        question: "En caso de que el médico suspenda una medicación después de un barrido, ¿cómo se reflejará en el sistema?",
                        options: { A: "El pedido original se cancela automáticamente", B: "La medicación suspendida deja de formar parte de la planificación futura y no se genera en nuevos pedidos", C: "El sistema genera una alerta en la interfaz de farmacia", D: "Se debe realizar una devolución manual del medicamento entregado" },
                        correct: ["B"], type: 'single'
                    },
                    {
                        question: "Durante el registro de la devolución, un envase de medicación está abierto y sin registro de administración. ¿Qué procedimiento debe seguir farmacia?",
                        options: { A: "Incorporarlo nuevamente al stock general si el contenido es suficiente", B: "Descartarlo como registro de devolucion y registrarlo con tal motivo en el sistema", C: "Realizar registro de la devolucion", D: "Notificar al sector de enfermería que el envase fue mal devuelto" },
                        correct: ["C"], type: 'single'
                    },
                    {
                        question: "Se reciben devoluciones al mismo tiempo que se genera un barrido. ¿Qué práctica garantiza una correcta gestión del stock?",
                        options: { A: "Registrar las devoluciones después del barrido", B: "Realizar el barrido nuevamente después de actualizar las devoluciones", C: "Ignorar las devoluciones si no están en condiciones", D: "Procesar devoluciones y barrido en orden indistinto" },
                        correct: ["B"], type: 'single'
                    },
                    {
                        question: "¿Qué pasos deben seguirse si al preparar un pedido falta un insumo y no hay stock disponible? (respuestas múltiples)",
                        options: { A: "Completar el resto del pedido y enviar", B: "Registrar la falta en sistema", C: "Informar al sector que el medicamento está en falta", D: "Generar una devolución parcial del pedido" },
                        correct: ["A", "B", "C"], type: 'multiple'
                    },
                    {
                        question: "En un turno nocturno, se encuentra un medicamento sin rotular ni registro asociado. ¿Cuál es la acción correcta del personal de farmacia?",
                        options: { A: "Consultar con enfermería y, si no hay objeciones, reutilizarlo", B: "Registrar el hallazgo como incidente y separarlo para descarte", C: "Etiquetarlo como \"en cuarentena\" hasta su identificación", D: "Incorporarlo directamente como stock no asignado" },
                        correct: ["B"], type: 'single'
                    },
                    {
                        question: "¿Qué función cumple el registro de devolución en el sistema? (respuestas múltiples)",
                        options: { A: "Permite mejorar el proceso de facturacion de medicamento-insumos", B: "Permite trazabilidad del stock no utilizado", C: "Sustituye la necesidad de revisar fechas de vencimiento", D: "Controla que farmacia no reciba más de lo entregado" },
                        correct: ["A", "B"], type: 'multiple'
                    }
                ]
            };

            const mcContainer1 = document.getElementById('mc-questions-container-1');
            const mcContainer2 = document.getElementById('mc-questions-container-2');

            evaluationData.multipleChoice.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'mc-question';
                let optionsHtml = '';
                const inputType = q.type === 'multiple' ? 'checkbox' : 'radio';

                for (const [key, value] of Object.entries(q.options)) {
                    optionsHtml += `
                        <div>
                            <label class="mc-option-label block p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition-colors">
                                <input type="${inputType}" name="question-${index}" value="${key}" class="mr-3 ${inputType === 'checkbox' ? 'rounded' : ''} text-teal-600 focus:ring-teal-500">
                                <strong>${key})</strong> ${value}
                            </label>
                        </div>
                    `;
                }
                questionDiv.innerHTML = `
                    <p class="text-lg font-semibold text-gray-700 mb-4">${index + 1}. ${q.question}</p>
                    <div class="space-y-3">${optionsHtml}</div>
                `;
                
                if (index < 8) {
                    mcContainer1.appendChild(questionDiv);
                } else {
                    mcContainer2.appendChild(questionDiv);
                }
            });

            const checkAnswersBtn = document.getElementById('check-answers-btn');
            checkAnswersBtn.addEventListener('click', () => {
                const reviewPassword = '31252025';
                const enteredPassword = prompt('Ingrese la contraseña numérica para revisar las respuestas:');

                if (enteredPassword === reviewPassword) {
                    evaluationData.multipleChoice.forEach((q, index) => {
                        const inputs = document.querySelectorAll(`input[name="question-${index}"]`);
                        
                        if (q.type === 'single') {
                            const selected = document.querySelector(`input[name="question-${index}"]:checked`);
                            inputs.forEach(input => {
                                const parentLabel = input.parentElement;
                                parentLabel.classList.remove('correct', 'incorrect');
                                if (input.value === q.correct[0]) {
                                    parentLabel.classList.add('correct');
                                } else if (selected && selected.value === input.value) {
                                    parentLabel.classList.add('incorrect');
                                }
                            });
                        } else { // type === 'multiple'
                            const selectedInputs = document.querySelectorAll(`input[name="question-${index}"]:checked`);
                            const selectedValues = Array.from(selectedInputs).map(input => input.value);

                            inputs.forEach(input => {
                                const parentLabel = input.parentElement;
                                parentLabel.classList.remove('correct', 'incorrect');

                                const isCorrect = q.correct.includes(input.value);
                                const isSelected = selectedValues.includes(input.value);

                                if (isCorrect) {
                                    parentLabel.classList.add('correct');
                                }
                                if (isSelected && !isCorrect) {
                                    parentLabel.classList.add('incorrect');
                                }
                            });
                        }
                    });
                    alert('Revisión completada. Las respuestas correctas están marcadas en verde.');
                } else if (enteredPassword !== null) {
                    alert('Contraseña incorrecta. No se pueden mostrar las respuestas.');
                }
            });

        });
    </script>
</body>
</html>
