<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proceso de Barrido en Farmacia IPAM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals with Teal Accent -->
    <!-- Application Structure Plan: Se ha dise√±ado una SPA de una sola p√°gina con desplazamiento vertical y una barra de navegaci√≥n fija. La estructura se divide en secciones tem√°ticas: 1) Introducci√≥n, 2) Flujo del Proceso Interactivo, 3) Comparativa por Sector, 4) Beneficios Clave, 5) Preguntas Frecuentes y 6) Evaluaci√≥n. Esta arquitectura fue elegida para transformar un documento procedimental en una gu√≠a de aprendizaje y evaluaci√≥n interactiva. -->
    <!-- Visualization & Content Choices: 1. Flujo del Proceso: Se reemplaz√≥ el diagrama est√°tico por una secuencia de pasos interactivos en HTML/CSS. 2. Comparativa de Sectores: Se us√≥ un gr√°fico de dona (Chart.js) y botones interactivos. 3. Beneficios: Se presentan en tarjetas con √≠conos (Unicode). 4. FAQ: Se implement√≥ un acorde√≥n con JS. 5. Evaluaci√≥n: Se a√±adi√≥ una secci√≥n con preguntas de opci√≥n m√∫ltiple (√∫nica y m√∫ltiple), con un bot√≥n de revisi√≥n final protegido por contrase√±a para mostrar las respuestas correctas. Justificaci√≥n: Estas elecciones priorizan la interacci√≥n y la claridad visual para facilitar el aprendizaje y la evaluaci√≥n de un proceso operativo. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 350px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        .step-connector {
            width: 2px;
            height: 100%;
            background-color: #D1D5DB;
            position: absolute;
            left: 20px;
            top: 20px;
            z-index: -1;
        }
        .step.active .step-icon {
            background-color: #14B8A6;
            color: white;
            transform: scale(1.1);
        }
        .step.active .step-content {
            border-color: #14B8A6;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .faq-item .faq-answer {
            display: none;
            transition: max-height 0.3s ease-out;
            overflow: hidden;
            max-height: 0;
        }
        .faq-item.open .faq-answer {
            display: block;
            max-height: 200px; /* Adjust as needed */
        }
        .faq-item.open .faq-icon {
            transform: rotate(180deg);
        }
        .sector-btn.active {
            background-color: #14B8A6;
            color: white;
            border-color: #14B8A6;
        }
        .mc-option-label.correct {
            background-color: #D1FAE5;
            border-color: #10B981;
            color: #065F46;
        }
        .mc-option-label.incorrect {
            background-color: #FEE2E2;
            border-color: #EF4444;
            color: #991B1B;
        }
    </style>
</head>
<body class="antialiased">

    <div id="password-overlay" class="fixed inset-0 bg-gray-100 z-50 flex items-center justify-center p-4">
        <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-sm text-center">
            <h2 class="text-2xl font-bold text-gray-800 mb-2">Acceso Restringido</h2>
            <p class="text-gray-600 mb-6">Esta documentaci√≥n es para uso interno.</p>
            <form id="password-form">
                <label for="password-input" class="sr-only">Contrase√±a</label>
                <input id="password-input" type="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-4 text-center focus:ring-2 focus:ring-teal-500 focus:border-teal-500" placeholder="Ingrese la contrase√±a" autofocus>
                <button type="submit" class="w-full bg-teal-600 text-white py-2 rounded-lg hover:bg-teal-700 transition-colors font-semibold">Ingresar</button>
                <p id="error-message" class="text-red-500 text-sm mt-4 hidden">Contrase√±a incorrecta. Intente de nuevo.</p>
            </form>
        </div>
    </div>

    <div id="main-content" class="hidden">
        <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-40">
            <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
                <div class="text-2xl font-bold text-teal-600">
                    <span class="text-gray-700">Farmacia Interna:</span> Proceso de Barrido
                </div>
                <div class="hidden md:flex space-x-6 text-gray-600 font-medium">
                    <a href="#proceso" class="hover:text-teal-600 transition-colors">El Proceso</a>
                    <a href="#comparativa" class="hover:text-teal-600 transition-colors">Por Sector</a>
                    <a href="#beneficios" class="hover:text-teal-600 transition-colors">Beneficios</a>
                    <a href="#faq" class="hover:text-teal-600 transition-colors">Preguntas Frecuentes</a>
                    <a href="#evaluacion" class="hover:text-teal-600 transition-colors">Evaluaci√≥n</a>
                </div>
                <button id="mobile-menu-button" class="md:hidden p-2 rounded-md hover:bg-gray-100 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </nav>
            <div id="mobile-menu" class="hidden md:hidden px-6 pb-4 space-y-2">
                 <a href="#proceso" class="block text-gray-600 hover:text-teal-600 transition-colors py-2">El Proceso</a>
                 <a href="#comparativa" class="block text-gray-600 hover:text-teal-600 transition-colors py-2">Por Sector</a>
                 <a href="#beneficios" class="block text-gray-600 hover:text-teal-600 transition-colors py-2">Beneficios</a>
                 <a href="#faq" class="block text-gray-600 hover:text-teal-600 transition-colors py-2">Preguntas Frecuentes</a>
                 <a href="#evaluacion" class="block text-gray-600 hover:text-teal-600 transition-colors py-2">Evaluaci√≥n</a>
            </div>
        </header>

        <main class="container mx-auto px-6 py-12 md:py-20">

            <section id="introduccion" class="text-center mb-20">
                <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">Entendiendo el Proceso de Barrido</h1>
                <p class="max-w-3xl mx-auto text-lg text-gray-600">
                    Una gu√≠a interactiva para comprender c√≥mo la farmacia interna garantiza el abastecimiento de medicamentos e insumos de manera eficiente y segura a todos los sectores del sanatorio.
                </p>
            </section>

            <section id="proceso" class="mb-20">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-4">El Flujo del Proceso, Paso a Paso</h2>
                <p class="text-center text-gray-600 mb-12 max-w-2xl mx-auto">
                    El barrido es una funci√≥n automatizada que transforma las necesidades de los pacientes en pedidos concretos para la farmacia. Haga clic en cada paso para ver los detalles y entender c√≥mo funciona el ciclo completo.
                </p>
                <div id="process-steps" class="relative">
                    <div class="step-connector hidden md:block"></div>
                    
                    <div class="step mb-8 md:flex items-start" data-step="1">
                        <div class="flex-shrink-0 mr-6 flex items-center mb-4 md:mb-0">
                            <div class="step-icon w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold text-lg transition-all duration-300">1</div>
                        </div>
                        <div class="step-content flex-grow bg-white p-6 rounded-lg border-2 border-transparent transition-all duration-300 cursor-pointer">
                            <h3 class="font-bold text-xl mb-2 text-gray-800">Inicio y Parametrizaci√≥n</h3>
                            <p class="text-gray-600">El personal de farmacia inicia el proceso presionando "Generacion de Pedidos.." y define los par√°metros clave: el **sector** a abastecer (ej. Piso 3) y un **rango horario** (ej. de 08:00 a 14:00).</p>
                        </div>
                    </div>

                    <div class="step mb-8 md:flex items-start" data-step="2">
                        <div class="flex-shrink-0 mr-6 flex items-center mb-4 md:mb-0">
                            <div class="step-icon w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold text-lg transition-all duration-300">2</div>
                        </div>
                        <div class="step-content flex-grow bg-white p-6 rounded-lg border-2 border-transparent transition-all duration-300 cursor-pointer">
                            <h3 class="font-bold text-xl mb-2 text-gray-800">An√°lisis Inteligente del Sistema</h3>
                            <p class="text-gray-600">El sistema revisa todos los pacientes del sector y sus prescripciones m√©dicas. Filtra y considera √∫nicamente los insumos y medicamentos planificados y que se necesitan dentro del rango horario seleccionado.</p>
                        </div>
                    </div>

                    <div class="step mb-8 md:flex items-start" data-step="3">
                        <div class="flex-shrink-0 mr-6 flex items-center mb-4 md:mb-0">
                            <div class="step-icon w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold text-lg transition-all duration-300">3</div>
                        </div>
                        <div class="step-content flex-grow bg-white p-6 rounded-lg border-2 border-transparent transition-all duration-300 cursor-pointer">
                            <h3 class="font-bold text-xl mb-2 text-gray-800">Generaci√≥n de Pedidos Adaptativa</h3>
                            <p class="text-gray-600">Aqu√≠ el proceso se adapta. Para **Internaci√≥n Com√∫n**, genera pedidos individuales por paciente. Para **Terapia/UCO**, se crean pedidos por paciente de insumos para reponer el stock del sector.</p>
                        </div>
                    </div>
                    
                    <div class="step mb-8 md:flex items-start" data-step="4">
                        <div class="flex-shrink-0 mr-6 flex items-center mb-4 md:mb-0">
                            <div class="step-icon w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold text-lg transition-all duration-300">4</div>
                        </div>
                        <div class="step-content flex-grow bg-white p-6 rounded-lg border-2 border-transparent transition-all duration-300 cursor-pointer">
                            <h3 class="font-bold text-xl mb-2 text-gray-800">Registro y Trazabilidad</h3>
                            <p class="text-gray-600">Todos los pedidos generados quedan registrados en el sistema con un ID √∫nico, fecha, usuario responsable y el detalle completo, asegurando una trazabilidad total del proceso.</p>
                        </div>
                    </div>

                    <div class="step md:flex items-start" data-step="5">
                        <div class="flex-shrink-0 mr-6 flex items-center mb-4 md:mb-0">
                            <div class="step-icon w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold text-lg transition-all duration-300">5</div>
                        </div>
                        <div class="step-content flex-grow bg-white p-6 rounded-lg border-2 border-transparent transition-all duration-300 cursor-pointer">
                            <h3 class="font-bold text-xl mb-2 text-gray-800">Preparaci√≥n y Entrega</h3>
                            <p class="text-gray-600">Con los pedidos ya generados, el equipo de farmacia prepara la medicaci√≥n y los insumos para su env√≠o al sector correspondiente, cerrando el ciclo de abastecimiento.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="comparativa" class="mb-20">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-4">Diferencias Clave por Tipo de Sector</h2>
                <p class="text-center text-gray-600 mb-12 max-w-2xl mx-auto">
                    El barrido no funciona igual para todos. La principal diferencia radica en si el sector maneja su propio stock de insumos.
                </p>
                <div class="lg:flex lg:space-x-12 items-center">
                    <div class="lg:w-1/3 mb-8 lg:mb-0">
                        <div class="chart-container">
                            <canvas id="sectorChart"></canvas>
                        </div>
                    </div>
                    <div class="lg:w-2/3">
                        <div class="mb-6 flex justify-center space-x-4">
                            <button class="sector-btn active px-6 py-2 border-2 border-gray-300 rounded-full font-medium transition-all" data-sector="comun">Internaci√≥n Com√∫n</button>
                            <button class="sector-btn px-6 py-2 border-2 border-gray-300 rounded-full font-medium transition-all" data-sector="criticos">Terapia / UCO</button>
                        </div>
                        <div class="bg-white p-8 rounded-lg shadow-md">
                            <div id="sector-info">
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="beneficios" class="mb-20">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Ventajas Principales del Barrido</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">‚úÖ</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Reduce Faltantes</h3>
                        <p class="text-gray-600">Al anticipar la demanda, se disminuye dr√°sticamente el riesgo de que falten medicamentos o insumos cr√≠ticos.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">‚öôÔ∏è</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Automatiza Pedidos</h3>
                        <p class="text-gray-600">Elimina la necesidad de generar pedidos manualmente, ahorrando tiempo y minimizando errores humanos.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">üîç</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Mejora la Trazabilidad</h3>
                        <p class="text-gray-600">Cada entrega queda registrada, permitiendo un control y seguimiento exhaustivo de los insumos dispensados.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">üéØ</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Evita Errores de Carga</h3>
                        <p class="text-gray-600">Al basarse en la prescripci√≥n m√©dica digital, se evitan errores de transcripci√≥n o interpretaci√≥n.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">üîÑ</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Proceso Adaptable</h3>
                        <p class="text-gray-600">El sistema se ajusta a la realidad operativa de cada sector, ya sea por paciente o por reposici√≥n de stock.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm hover:shadow-lg transition-shadow">
                        <div class="text-3xl mb-4 text-teal-500">‚è∞</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">Optimiza el Tiempo</h3>
                        <p class="text-gray-600">Permite al personal de farmacia y enfermer√≠a enfocarse en tareas de mayor valor, mejorando la eficiencia general.</p>
                    </div>
                </div>
            </section>

            <section id="faq" class="mb-20">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Preguntas Frecuentes</h2>
                <div class="max-w-3xl mx-auto space-y-4">
                    <div class="faq-item bg-white rounded-lg shadow-sm overflow-hidden">
                        <div class="faq-question flex justify-between items-center p-6 cursor-pointer">
                            <h3 class="font-semibold text-lg text-gray-800">¬øQu√© pasa si realizo un barrido para un per√≠odo que ya pas√≥?</h3>
                            <div class="faq-icon text-gray-500 transition-transform duration-300">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                        </div>
                        <div class="faq-answer px-6 pb-6 text-gray-600">
                            <p>Es posible volver a ejecutar un barrido sobre un per√≠odo ya procesado.
En ese caso, el sistema no genera pedidos duplicados.

Si ya se generaron pedidos y fueron procesados correctamente, el sistema no los vuelve a incluir.

Si los pedidos generados a√∫n no fueron procesados (es decir, no se prepararon ni se enviaron), siguen vigentes.

Si hubo modificaciones en la planificaci√≥n (por ejemplo, cambios en indicaciones m√©dicas), entonces el sistema genera nuevos pedidos actualizados para reflejar esos cambios. </p>
                        </div>
                    </div>
                    <div class="faq-item bg-white rounded-lg shadow-sm overflow-hidden">
                        <div class="faq-question flex justify-between items-center p-6 cursor-pointer">
                            <h3 class="font-semibold text-lg text-gray-800">¬øCon cu√°nta anticipaci√≥n debo realizar el barrido?</h3>
                            <div class="faq-icon text-gray-500 transition-transform duration-300">
                               <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                        </div>
                        <div class="faq-answer px-6 pb-6 text-gray-600">
                            <p>Depende de los cronogramas de cada sector. Como regla general, se recomienda realizarlo con un m√≠nimo de **2 a 4 horas de antelaci√≥n** para dar tiempo suficiente a la preparaci√≥n y el env√≠o de los insumos.</p>
                        </div>
                    </div>
                     <div class="faq-item bg-white rounded-lg shadow-sm overflow-hidden">
                        <div class="faq-question flex justify-between items-center p-6 cursor-pointer">
                            <h3 class="font-semibold text-lg text-gray-800">¬øEl barrido incluye medicaci√≥n "SOS" o "seg√∫n necesidad"?</h3>
                            <div class="faq-icon text-gray-500 transition-transform duration-300">
                               <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                        </div>
                        <div class="faq-answer px-6 pb-6 text-gray-600">
                            <p>S√≠. El barrido incluye tanto los medicamentos programados con horario espec√≠fico seg√∫n la prescripci√≥n m√©dica, como aquellos indicados como ‚ÄúSOS‚Äù, siempre que est√©n vigentes dentro del rango horario seleccionado.</p>
                        </div>
                    </div>
                    <div class="faq-item bg-white rounded-lg shadow-sm overflow-hidden">
                        <div class="faq-question flex justify-between items-center p-6 cursor-pointer">
                            <h3 class="font-semibold text-lg text-gray-800">¬øQu√© ocurre si un m√©dico cambia una prescripci√≥n despu√©s del barrido?</h3>
                            <div class="faq-icon text-gray-500 transition-transform duration-300">
                               <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                        </div>
                        <div class="faq-answer px-6 pb-6 text-gray-600">
                            <p>El barrido representa una ‚Äúfoto‚Äù del estado de la prescripci√≥n m√©dica y la planificaci√≥n de administraci√≥n en el momento en que se ejecuta.
Cualquier cambio posterior ‚Äîcomo una suspensi√≥n, una nueva indicaci√≥n, una modificaci√≥n de dosis u horario, o un ajuste en la planificaci√≥n‚Äî no se refleja autom√°ticamente en el pedido ya generado.
Para que esos cambios se vean reflejados, debe realizarse un nuevo barrido, que genere un pedido actualizado.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="evaluacion" class="bg-white p-8 rounded-lg shadow-md">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-2">Evaluaci√≥n de Conocimientos</h2>
                <p class="text-center text-gray-600 mb-10">Verifique su comprensi√≥n del proceso de barrido y gesti√≥n de stock.</p>

                <div class="max-w-4xl mx-auto">
                    <div class="mb-8">
                        <label for="evaluado-nombre" class="block text-lg font-medium text-gray-700 mb-2">Nombre del Evaluado:</label>
                        <input type="text" id="evaluado-nombre" name="evaluado-nombre" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500" placeholder="Ingrese su nombre y apellido">
                        <div class="text-center mt-4">
                            <button id="start-evaluation-btn" class="bg-teal-600 text-white py-2 px-6 rounded-lg hover:bg-teal-700 transition-colors font-semibold">Comenzar Evaluaci√≥n</button>
                            <p id="name-error" class="text-red-500 text-sm mt-2 hidden">Por favor, ingrese su nombre para comenzar.</p>
                        </div>
                    </div>

                    <div id="evaluation-content" class="hidden">
                        <h3 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2">Parte 1: Comprensi√≥n t√©cnica</h3>
                        <div id="mc-questions-container-1" class="space-y-8"></div>

                        <h3 class="text-2xl font-bold text-gray-800 mt-12 mb-6 border-b pb-2">Parte 2: Situaciones pr√°cticas complejas</h3>
                        <div id="mc-questions-container-2" class="space-y-8"></div>
                        
                        <div class="text-center mt-12">
                            <button id="check-answers-btn" class="bg-teal-600 text-white py-3 px-8 rounded-lg hover:bg-teal-700 transition-colors font-semibold text-lg">Revisar Respuestas Correctas</button>
                        </div>
                    </div>
                </div>
            </section>

        </main>
        
        <footer class="bg-gray-800 text-white mt-20">
            <div class="container mx-auto px-6 py-8 text-center">
                <p>&copy; 2024 Sanatorio IPAM. Documentaci√≥n de Procesos Internos.</p>
                <p class="text-sm text-gray-400 mt-2">Documentaci√≥n realizada por Emanuel Fleier (Depto. Sistemas).</p>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            const passwordOverlay = document.getElementById('password-overlay');
            const passwordForm = document.getElementById('password-form');
            const passwordInput = document.getElementById('password-input');
            const errorMessage = document.getElementById('error-message');
            const mainContent = document.getElementById('main-content');

            const correctPassword = 'ipam';

            passwordForm.addEventListener('submit', function(e) {
                e.preventDefault();
                if (passwordInput.value === correctPassword) {
                    passwordOverlay.style.display = 'none';
                    mainContent.classList.remove('hidden');
                } else {
                    errorMessage.classList.remove('hidden');
                    passwordInput.value = '';
                    passwordInput.focus();
                }
            });

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            const processSteps = document.querySelectorAll('.step');
            processSteps.forEach(step => {
                step.addEventListener('click', () => {
                    processSteps.forEach(s => s.classList.remove('active'));
                    step.classList.add('active');
                });
            });
            if (processSteps.length > 0) {
                processSteps[0].classList.add('active');
            }

            const sectorData = {
                comun: {
                    title: 'Internaci√≥n Com√∫n',
                    details: [
                        { label: '¬øManeja stock propio?', value: 'No', icon: '‚ùå' },
                        { label: 'Finalidad del barrido', value: 'Enviar medicaci√≥n espec√≠fica por paciente', icon: 'üéØ' },
                        { label: 'Tipo de pedido generado', value: 'Pedido individual por paciente', icon: 'üìÑ' }
                    ]
                },
                criticos: {
                    title: 'Terapia / UCO (Sectores Cr√≠ticos)',
                    details: [
                        { label: '¬øManeja stock propio?', value: 'S√≠', icon: '‚úÖ' },
                        { label: 'Finalidad del barrido', value: 'Reponer el stock general del sector', icon: 'üéØ' },
                        { label: 'Tipo de pedido generado', value: 'Pedido individual por paciente', icon: 'üìÑ' }
                    ]
                }
            };

            const sectorInfoContainer = document.getElementById('sector-info');
            const sectorButtons = document.querySelectorAll('.sector-btn');

            function updateSectorInfo(sector) {
                const data = sectorData[sector];
                let html = `<h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">${data.title}</h3><div class="space-y-4">`;
                data.details.forEach(item => {
                    html += `
                        <div class="flex items-start">
                            <div class="text-2xl mr-4">${item.icon}</div>
                            <div>
                                <p class="font-semibold text-gray-500">${item.label}</p>
                                <p class="text-lg text-gray-800">${item.value}</p>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                sectorInfoContainer.innerHTML = html;
            }

            sectorButtons.forEach(button => {
                button.addEventListener('click', () => {
                    sectorButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    updateSectorInfo(button.dataset.sector);
                });
            });

            updateSectorInfo('comun');

            const ctx = document.getElementById('sectorChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Internaci√≥n Com√∫n', 'Sectores Cr√≠ticos (Terapia/UCO)'],
                    datasets: [{
                        label: 'Tipos de Sector',
                        data: [70, 30],
                        backgroundColor: [
                            '#2DD4BF',
                            '#0D9488'
                        ],
                        borderColor: '#FDFBF8',
                        borderWidth: 4,
                        hoverOffset: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 14,
                                    family: 'Inter'
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed + '% (Representaci√≥n)';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            const faqItems = document.querySelectorAll('.faq-item');
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                question.addEventListener('click', () => {
                    const isOpen = item.classList.contains('open');
                    faqItems.forEach(i => i.classList.remove('open'));
                    if (!isOpen) {
                        item.classList.add('open');
                    }
                });
            });

            // --- EVALUATION SCRIPT ---
            const nameInput = document.getElementById('evaluado-nombre');
            const startEvaluationBtn = document.getElementById('start-evaluation-btn');
            const nameError = document.getElementById('name-error');
            const evaluationContent = document.getElementById('evaluation-content');

            startEvaluationBtn.addEventListener('click', () => {
                if (nameInput.value.trim() === '') {
                    nameError.classList.remove('hidden');
                } else {
                    nameError.classList.add('hidden');
                    evaluationContent.classList.remove('hidden');
                    nameInput.disabled = true;
                    startEvaluationBtn.parentElement.style.display = 'none';
                }
            });

            const evaluationData = {
                multipleChoice: [
                    {
                        question: "¬øCu√°l es el objetivo del barrido realizado por farmacia en sectores sin stock propio, como internaci√≥n general?",
                        options: { A: "Confirmar que todos los medicamentos hayan sido administrados correctamente", B: "Identificar los medicamentos que podr√≠an reutilizarse en otros sectores", C: "Anticiparse a las necesidades de cada paciente generando pedidos por planificaci√≥n futura", D: "Realizar auditor√≠as retrospectivas sobre tratamientos administrados" },
                        correct: ["C"], type: 'single'
                    },
                    {
                        question: "Al realizar un barrido en un rango horario que ya fue previamente procesado, el sistema:",
                        options: { A: "Reemplaza los pedidos anteriores por versiones m√°s recientes", B: "Genera alertas de duplicaci√≥n y detiene el proceso", C: "No vuelve a generar pedidos para lo que ya fue procesado", D: "Elimina autom√°ticamente los pedidos previos y vuelve a generarlos" },
                        correct: ["C"], type: 'single'
                    },
                    {
                        question: "¬øCu√°ndo se considera que se van a generar nuevos pedidos para pacientes luego de un barrido previo?",
                        options: { A: "Siempre que haya un cambio en la planificaci√≥n o en la medicaci√≥n indicada", B: "Cuando el m√©dico repite la indicaci√≥n sin modificar horario o dosis", C: "Solo si se han entregado todos los insumos anteriores", D: "Si el sistema detecta devoluciones desde el sector" },
                        correct: ["A"], type: 'single'
                    },
                    {
                        question: "En sectores como Terapia Intensiva o UCO, ¬øCual es el motivo principal de la generacion de pedidos (barridos)?",
                        options: { A: "Porque estos sectores utilizan prescripci√≥n m√©dicas individualizada", B: "Porque los medicamentos se administran a demanda sin planificaci√≥n", C: "Porque mantienen stock en dep√≥sito, y el barrido sirve para reponer lo consumido.", D: "Porque ambos sectores comparten stock" },
                        correct: ["C"], type: 'single'
                    },
                    {
                        question: "¬øQu√© tipo de medicaci√≥n/insumos es incluida por el sistema en un barrido? (selecci√≥n m√∫ltiple)",
                        options: { A: "Medicaci√≥n pautada con horario fijo", B: "Medicaci√≥n \"SOS\" activa en la planificacion", C: "Insumos registrados como \"entregados previamente\"", D: "Medicaci√≥n suspendida luego del barrido" },
                        correct: ["A", "B"], type: 'multiple'
                    },
                    {
                        question: "¬øCu√°l de las siguientes acciones debe realizar farmacia antes de reincorporar un medicamento al stock general?",
                        options: { A: "Confirmar que no haya sido administrado y est√© en condiciones adecuadas", B: "Validar en sistema que no est√© planificado nuevamente", C: "Solicitar autorizaci√≥n m√©dica antes de su reintegro", D: "Reetiquetar el producto para indicar que es reutilizable" },
                        correct: ["A"], type: 'single'
                    },
                    {
                        question: "¬øEn qu√© situaci√≥n el personal de farmacia no deber√≠a realizar un nuevo barrido?",
                        options: { A: "Al recibir una nueva indicaci√≥n m√©dica urgente", B: "Si el barrido ya se hizo para ese per√≠odo y no hubo cambios", C: "Cuando se modifica la planificaci√≥n de horarios de medicaci√≥n", D: "Si se agregan medicamentos nuevos a un paciente internado" },
                        correct: ["C"], type: 'single'
                    },
                    {
                        question: "¬øPor qu√© no es recomendable realizar un barrido con una fecha y hora en el pasado?",
                        options: { A: "Porque el sistema puede sobreescribir los registros cl√≠nicos", B: "Porque se generar√≠an pedidos de insumos ya administrados o vencidos", C: "Porque se pierde trazabilidad de las entregas", D: "Ninguna de las anteriores" },
                        correct: ["D"], type: 'single'
                    },
                    {
                        question: "Al preparar un pedido generado por barrido, farmacia detecta que un insumo est√° pr√≥ximo a vencer. ¬øQu√© debe hacer?",
                        options: { A: "Utilizarlo primero si est√° dentro del rango de seguridad", B: "Cambiar el medicamento por otro del mismo grupo farmacol√≥gico", C: "Consultar con el m√©dico tratante antes de incluirlo en el pedido", D: "Eliminarlo del pedido directamente" },
                        correct: ["A"], type: 'single'
                    },
                    {
                        question: "En caso de que el m√©dico suspenda una medicaci√≥n despu√©s de un barrido, ¬øc√≥mo se reflejar√° en el sistema?",
                        options: { A: "El pedido original se cancela autom√°ticamente", B: "La medicaci√≥n suspendida deja de formar parte de la planificaci√≥n futura y no se genera en nuevos pedidos", C: "El sistema genera una alerta en la interfaz de farmacia", D: "Se debe realizar una devoluci√≥n manual del medicamento entregado" },
                        correct: ["B"], type: 'single'
                    },
                    {
                        question: "Durante el registro de la devoluci√≥n, un envase de medicaci√≥n est√° abierto y sin registro de administraci√≥n. ¬øQu√© procedimiento debe seguir farmacia?",
                        options: { A: "Incorporarlo nuevamente al stock general si el contenido es suficiente", B: "Descartarlo como registro de devolucion y registrarlo con tal motivo en el sistema", C: "Realizar registro de la devolucion", D: "Notificar al sector de enfermer√≠a que el envase fue mal devuelto" },
                        correct: ["C"], type: 'single'
                    },
                    {
                        question: "Se reciben devoluciones al mismo tiempo que se genera un barrido. ¬øQu√© pr√°ctica garantiza una correcta gesti√≥n del stock?",
                        options: { A: "Registrar las devoluciones despu√©s del barrido", B: "Realizar el barrido nuevamente despu√©s de actualizar las devoluciones", C: "Ignorar las devoluciones si no est√°n en condiciones", D: "Procesar devoluciones y barrido en orden indistinto" },
                        correct: ["B"], type: 'single'
                    },
                    {
                        question: "¬øQu√© pasos deben seguirse si al preparar un pedido falta un insumo y no hay stock disponible? (respuestas m√∫ltiples)",
                        options: { A: "Completar el resto del pedido y enviar", B: "Registrar la falta en sistema", C: "Informar al sector que el medicamento est√° en falta", D: "Generar una devoluci√≥n parcial del pedido" },
                        correct: ["A", "B", "C"], type: 'multiple'
                    },
                    {
                        question: "En un turno nocturno, se encuentra un medicamento sin rotular ni registro asociado. ¬øCu√°l es la acci√≥n correcta del personal de farmacia?",
                        options: { A: "Consultar con enfermer√≠a y, si no hay objeciones, reutilizarlo", B: "Registrar el hallazgo como incidente y separarlo para descarte", C: "Etiquetarlo como \"en cuarentena\" hasta su identificaci√≥n", D: "Incorporarlo directamente como stock no asignado" },
                        correct: ["B"], type: 'single'
                    },
                    {
                        question: "¬øQu√© funci√≥n cumple el registro de devoluci√≥n en el sistema? (respuestas m√∫ltiples)",
                        options: { A: "Permite mejorar el proceso de facturacion de medicamento-insumos", B: "Permite trazabilidad del stock no utilizado", C: "Sustituye la necesidad de revisar fechas de vencimiento", D: "Controla que farmacia no reciba m√°s de lo entregado" },
                        correct: ["A", "B"], type: 'multiple'
                    }
                ]
            };

            const mcContainer1 = document.getElementById('mc-questions-container-1');
            const mcContainer2 = document.getElementById('mc-questions-container-2');

            evaluationData.multipleChoice.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'mc-question';
                let optionsHtml = '';
                const inputType = q.type === 'multiple' ? 'checkbox' : 'radio';

                for (const [key, value] of Object.entries(q.options)) {
                    optionsHtml += `
                        <div>
                            <label class="mc-option-label block p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition-colors">
                                <input type="${inputType}" name="question-${index}" value="${key}" class="mr-3 ${inputType === 'checkbox' ? 'rounded' : ''} text-teal-600 focus:ring-teal-500">
                                <strong>${key})</strong> ${value}
                            </label>
                        </div>
                    `;
                }
                questionDiv.innerHTML = `
                    <p class="text-lg font-semibold text-gray-700 mb-4">${index + 1}. ${q.question}</p>
                    <div class="space-y-3">${optionsHtml}</div>
                `;
                
                if (index < 8) {
                    mcContainer1.appendChild(questionDiv);
                } else {
                    mcContainer2.appendChild(questionDiv);
                }
            });

            const checkAnswersBtn = document.getElementById('check-answers-btn');
            checkAnswersBtn.addEventListener('click', () => {
                const reviewPassword = '31252025';
                const enteredPassword = prompt('Ingrese la contrase√±a num√©rica para revisar las respuestas:');

                if (enteredPassword === reviewPassword) {
                    evaluationData.multipleChoice.forEach((q, index) => {
                        const inputs = document.querySelectorAll(`input[name="question-${index}"]`);
                        
                        if (q.type === 'single') {
                            const selected = document.querySelector(`input[name="question-${index}"]:checked`);
                            inputs.forEach(input => {
                                const parentLabel = input.parentElement;
                                parentLabel.classList.remove('correct', 'incorrect');
                                if (input.value === q.correct[0]) {
                                    parentLabel.classList.add('correct');
                                } else if (selected && selected.value === input.value) {
                                    parentLabel.classList.add('incorrect');
                                }
                            });
                        } else { // type === 'multiple'
                            const selectedInputs = document.querySelectorAll(`input[name="question-${index}"]:checked`);
                            const selectedValues = Array.from(selectedInputs).map(input => input.value);

                            inputs.forEach(input => {
                                const parentLabel = input.parentElement;
                                parentLabel.classList.remove('correct', 'incorrect');

                                const isCorrect = q.correct.includes(input.value);
                                const isSelected = selectedValues.includes(input.value);

                                if (isCorrect) {
                                    parentLabel.classList.add('correct');
                                }
                                if (isSelected && !isCorrect) {
                                    parentLabel.classList.add('incorrect');
                                }
                            });
                        }
                    });
                    alert('Revisi√≥n completada. Las respuestas correctas est√°n marcadas en verde.');
                } else if (enteredPassword !== null) {
                    alert('Contrase√±a incorrecta. No se pueden mostrar las respuestas.');
                }
            });

        });
    </script>
</body>
</html>
